---
import { SITE_TITLE } from '../../consts';
import HeaderLink from './HeaderLink.astro';
import ThemeToggle from '../ui/button/ThemeToggle.astro';

// Base para GitHub Pages cuando el repo es brianrep.github.io
const BASE = '/brianrep.github.io';
---

<header class="bg-background text-foreground border-b sw-header">
  <nav class="mx-auto max-w-6xl px-4 py-2 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <a class="no-underline hover:opacity-90 flex items-center gap-2" href={`${BASE}/`} aria-label="Home">
        <img src={`${BASE}/favicon.png?v=1`} alt="" aria-hidden="true" width="45" height="45" />
      </a>

      <div class="internal-links hidden md:flex items-center gap-2 ml-1">
        <HeaderLink href={`${BASE}/`} class="px-2 py-3 text-[color:var(--color-text-secondary)] no-underline">Home</HeaderLink>
        <HeaderLink href={`${BASE}/portfolio`} class="px-2 py-3 text-[color:var(--color-text-secondary)] no-underline">Portfolio</HeaderLink>
        <HeaderLink href={`${BASE}/about`} class="px-2 py-3 text-[color:var(--color-text-secondary)] no-underline">About</HeaderLink>
        <HeaderLink href={`${BASE}/blog`} class="px-2 py-3 text-[color:var(--color-text-secondary)] no-underline">Blog</HeaderLink>
        <a href="#contact" class="px-2 py-3 text-[color:var(--color-text-secondary)] no-underline">Contact</a>
      </div>
    </div>

    <div class="flex items-center gap-3">
      <!-- Social links (desktop) -->
      <div class="social-links hidden md:flex items-center gap-3">
        <!-- LinkedIn -->
        <a
          href="https://www.linkedin.com/in/briannunezo/"
          target="_blank"
          rel="noopener noreferrer"
          class="group text-[color:var(--color-text-secondary)]"
        >
          <span class="sr-only">LinkedIn</span>
          <svg
            viewBox="0 0 24 24"
            width="24"
            height="24"
            aria-hidden="true"
            class="transition-colors group-hover:text-[color:var(--accent)]"
          >
            <path
              fill="currentColor"
              d="M4.98 3.5C4.98 4.88 3.88 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5ZM.5 8.5H4.5V23H.5V8.5ZM8.5 8.5H12.3V10.5H12.35C12.88 9.5 14.2 8.45 16.15 8.45 20.2 8.45 21 11.1 21 14.55V23H17V15.35C17 13.45 16.95 11.05 14.35 11.05 11.75 11.05 11.35 13.1 11.35 15.25V23H7.35V8.5H8.5Z"
            />
          </svg>
        </a>

        <!-- GitHub -->
        <a href="https://github.com/Stark12345" target="_blank" class="group text-[color:var(--color-text-secondary)]">
          <span class="sr-only">GitHub</span>
          <svg viewBox="0 0 16 16" aria-hidden="true" width="24" height="24"
               class="transition-colors group-hover:text-[color:var(--accent)]">
            <path fill="currentColor"
              d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38
                 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13
                 -.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66
                 .07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95
                 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12
                 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27
                 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12
                 .51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95
                 .29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2
                 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
          </svg>
        </a>
      </div>

      <ThemeToggle />

      <button
        type="button"
        aria-label="Open menu"
        aria-controls="mobile-menu"
        aria-expanded="false"
        data-menu-btn
        class="md:hidden inline-flex items-center justify-center w-10 h-10 rounded-lg text-[color:var(--color-text-secondary)] hover:text-white"
      >
        <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
          <path fill="currentColor" d="M3 6h18v2H3V6Zm0 5h18v2H3v-2Zm0 5h18v2H3v-2Z"/>
        </svg>
      </button>
    </div>
  </nav>

  <!-- Mobile menu -->
  <div id="mobile-menu" class="md:hidden hidden border-t">
    <div class="mx-auto max-w-6xl px-4 py-3 flex flex-col gap-2">
      <div class="flex flex-col">
        <HeaderLink href={`${BASE}/`} class="px-2 py-3">Home</HeaderLink>
        <HeaderLink href={`${BASE}/portfolio`} class="px-2 py-3">Portfolio</HeaderLink>
        <HeaderLink href={`${BASE}/about`} class="px-2 py-3">About</HeaderLink>
        <HeaderLink href={`${BASE}/blog`} class="px-2 py-3">Blog</HeaderLink>
        <a href="#contact" class="px-2 py-3">Contact</a>
      </div>

      <div class="flex items-center gap-4 pt-2">
        <!-- LinkedIn (mobile) -->
        <a href="https://www.linkedin.com/in/briannunezo/" target="_blank"
           class="group inline-flex items-center text-[color:var(--color-text-secondary)]">
          <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true"
               class="transition-colors group-hover:text-white">
            <path fill="currentColor"
              d="M4.98 3.5C4.98 4.88 3.88 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1
                 4.98 2.12 4.98 3.5ZM.5 8.5H4.5V23H.5V8.5ZM8.5 8.5H12.3V10.5H12.35
                 C12.88 9.5 14.2 8.45 16.15 8.45 20.2 8.45 21 11.1 21 14.55
                 V23H17V15.35C17 13.45 16.95 11.05 14.35 11.05
                 11.75 11.05 11.35 13.1 11.35 15.25V23H7.35V8.5H8.5Z"/>
          </svg>
        </a>

        <!-- GitHub (mobile) -->
        <a href="https://github.com/Stark12345" target="_blank"
           class="group inline-flex items-center text-[color:var(--color-text-secondary)]">
          <svg viewBox="0 0 16 16" aria-hidden="true" width="22" height="22"
               class="transition-colors group-hover:text-white">
            <path fill="currentColor"
              d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59
                 .4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49
                 -2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13
                 -.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82
                 .72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07
                 -1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15
                 -.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82
                 .64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27
                 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12
                 .51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95
                 .29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2
                 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8
                 c0-4.42-3.58-8-8-8z"/>
          </svg>
        </a>
      </div>
    </div>
  </div>
</header>

<script is:inline>
  const btn = document.querySelector('[data-menu-btn]');
  const panel = document.getElementById('mobile-menu');
  function toggleMenu() {
    if (!panel || !btn) return;
    const isOpen = !panel.classList.contains('hidden');
    panel.classList.toggle('hidden');
    btn.setAttribute('aria-expanded', String(!isOpen));
  }
  btn?.addEventListener('click', toggleMenu);
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && panel && !panel.classList.contains('hidden')) toggleMenu();
  });
  document.addEventListener('click', (e) => {
    if (!panel || !btn) return;
    const target = e.target;
    if (!panel.contains(target) && !btn.contains(target) && !panel.classList.contains('hidden')) {
      toggleMenu();
    }
  });
</script>
